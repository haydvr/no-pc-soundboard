<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Loudboard</title>
<style>
body {
  background:#111;
  color:#fff;
  font-family:Arial, sans-serif;
  margin:0;
  padding:20px;
}
h1 { text-align:center; }

.controls { text-align:center; margin-bottom:10px; }

button {
  padding:6px 12px;
  margin:2px;
  background:#444;
  color:#fff;
  border:none;
  border-radius:6px;
  cursor:pointer;
}
button:hover { background:#666; }
button:disabled { opacity:0.4; cursor:not-allowed; }

#dropzone {
  border:2px dashed #555;
  padding:20px;
  text-align:center;
  margin-bottom:15px;
}

.track {
  display:flex;
  align-items:center;
  gap:6px;
  margin-bottom:6px;
}

.track span {
  flex:1;
  white-space:nowrap;
  overflow:hidden;
  text-overflow:ellipsis;
}

input[type=range] { width:90px; }

#searchBar {
  width:90%;
  max-width:500px;
  padding:6px;
  margin:10px auto;
  display:block;
  border-radius:6px;
  border:1px solid #555;
}

.category {
  font-size:11px;
  background:#222;
  padding:2px 6px;
  border-radius:4px;
  margin-left:6px;
}

#readThis {
  background:#1a1a1a;
  padding:12px;
  border-radius:8px;
  margin-bottom:15px;
}

#subscribe {
  margin-top:30px;
  font-size:40px;
  font-weight:bold;
  color:red;
  text-align:center;
  cursor:pointer;
}
</style>
</head>
<body>

<h1>Loudboard</h1>

<div class="controls">
  <button id="addFiles">Add Files</button>
  <button id="addFolder">Add Folder</button>
  <button id="stopAll">Stop All</button>
  <button id="ownerBtn">Owner Stuff</button>
</div>

<div class="controls">
  Master Volume:
  <input id="master" type="range" min="100" max="1000" value="100">
  <span id="masterVal">100%</span>
</div>

<input id="searchBar" placeholder="Search sounds or categories">

<div id="readThis">
  <h3>READ THIS</h3>
  <ol>
    <li>Click anywhere once to unlock audio.</li>
    <li>Add sounds using drag & drop or the buttons.</li>
    <li>Use Play / Restart / Mute per sound.</li>
    <li>Search filters by name or category.</li>
    <li>Owner mode unlocks looping, categories, 40000% volume, and panic mute (M).</li>
  </ol>

  <p style="margin-top:10px;">
    <strong>Bonus Tip:</strong><br>
    i recomend putting the sound files in whatever your main downloads folder is.
    For computer this is easy, but if your on phone im not sure â€” so wherever files go
    automatically when you download them, go there and move the sound files.
    Also put the sounds directly in the downloads and not in a subfolder and everything
    should work.
  </p>
</div>

<div id="dropzone">Drag & Drop MP3 / WAV files here</div>

<div id="tracks"></div>

<input id="fileInput" type="file" multiple accept="audio/*" hidden>
<input id="folderInput" type="file" webkitdirectory hidden>

<div id="subscribe"
onclick="window.open('https://www.youtube.com/@Haydenplaysvr1','_blank')">
SUBSCRIBE TO HAYDVR
</div>

<script>
const ctx = new (window.AudioContext || window.webkitAudioContext)();
const masterGain = ctx.createGain();
masterGain.connect(ctx.destination);
masterGain.gain.value = 1;

document.body.addEventListener("click", () => {
  if (ctx.state === "suspended") ctx.resume();
}, { once:true });

const OWNER_PASS = "pokemon/admin132";
let owner = false;
let panic = false;
let savedGain = 1;

ownerBtn.onclick = () => {
  if (owner) return;
  if (prompt("Owner password:") !== OWNER_PASS) return alert("Wrong password");
  owner = true;
  master.max = 40000;
  document.querySelectorAll(".ownerOnly").forEach(b => b.disabled = false);
  alert("Owner mode unlocked");
};

document.addEventListener("keydown", e => {
  if (!owner || e.key.toLowerCase() !== "m") return;
  if (!panic) {
    savedGain = masterGain.gain.value;
    masterGain.gain.value = 0;
    masterVal.textContent = "MUTED";
    panic = true;
  } else {
    masterGain.gain.value = savedGain;
    masterVal.textContent = master.value + "%";
    panic = false;
  }
});

master.oninput = () => {
  if (!panic) {
    masterGain.gain.value = master.value / 100;
    masterVal.textContent = master.value + "%";
  }
};

const tracksDiv = document.getElementById("tracks");
const trackData = [];

function addTrack(file) {
  if (!file.type.startsWith("audio/")) return;

  const reader = new FileReader();
  reader.onload = async () => {
    const buffer = await ctx.decodeAudioData(reader.result);

    const track = {
      name:file.name,
      buffer,
      loop:false,
      category:"",
      source:null,
      gain:ctx.createGain()
    };
    track.gain.connect(masterGain);
    trackData.push(track);

    const row = document.createElement("div");
    row.className = "track";

    const label = document.createElement("span");
    label.textContent = file.name;

    const play = document.createElement("button");
    play.textContent = "Play";

    const restart = document.createElement("button");
    restart.textContent = "Restart";

    const mute = document.createElement("button");
    mute.textContent = "Mute";

    const vol = document.createElement("input");
    vol.type="range"; vol.min=0; vol.max=2; vol.step=0.01; vol.value=1;

    const loopBtn = document.createElement("button");
    loopBtn.textContent="Loop";
    loopBtn.className="ownerOnly";
    loopBtn.disabled=true;

    const catBtn = document.createElement("button");
    catBtn.textContent="Category";
    catBtn.className="ownerOnly";
    catBtn.disabled=true;

    function playSound() {
      if (track.source) track.source.stop();
      track.source = ctx.createBufferSource();
      track.source.buffer = track.buffer;
      track.source.loop = track.loop;
      track.source.connect(track.gain);
      track.source.start();
    }

    play.onclick = playSound;
    restart.onclick = playSound;

    mute.onclick = () => {
      if (track.gain.gain.value > 0) {
        track.gain.gain.value = 0;
        mute.textContent = "Unmute";
      } else {
        track.gain.gain.value = vol.value;
        mute.textContent = "Mute";
      }
    };

    vol.oninput = () => {
      if (track.gain.gain.value > 0) track.gain.gain.value = vol.value;
    };

    loopBtn.onclick = () => {
      track.loop = !track.loop;
      loopBtn.textContent = track.loop ? "Looping" : "Loop";
      if (track.source) track.source.loop = track.loop;
    };

    catBtn.onclick = () => {
      const c = prompt("Category name:", track.category);
      if (!c) return;
      track.category = c;
      label.innerHTML = file.name + `<span class="category">${c}</span>`;
    };

    row.append(label, play, restart, mute, vol, loopBtn, catBtn);
    tracksDiv.appendChild(row);
  };
  reader.readAsArrayBuffer(file);
}

addFiles.onclick = () => fileInput.click();
addFolder.onclick = () => folderInput.click();
fileInput.onchange = e => [...e.target.files].forEach(addTrack);
folderInput.onchange = e => [...e.target.files].forEach(addTrack);

dropzone.ondragover = e => e.preventDefault();
dropzone.ondrop = e => {
  e.preventDefault();
  [...e.dataTransfer.files].forEach(addTrack);
};

stopAll.onclick = () => {
  trackData.forEach(t => { if (t.source) try{t.source.stop()}catch{} });
};

searchBar.oninput = () => {
  const q = searchBar.value.toLowerCase();
  [...tracksDiv.children].forEach((row,i)=>{
    const t = trackData[i];
    row.style.display =
      t.name.toLowerCase().includes(q) ||
      t.category.toLowerCase().includes(q)
      ? "" : "none";
  });
};
</script>
</body>
</html>
